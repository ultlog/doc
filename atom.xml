<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ultlog</title>
  
  <subtitle>ultlog docs</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://ultlog.com/"/>
  <updated>2020-07-29T15:07:50.969Z</updated>
  <id>http://ultlog.com/</id>
  
  <author>
    <name>will</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>性能测试</title>
    <link href="http://ultlog.com/2020/07/29/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/%E6%B5%8B%E8%AF%95/benchmark/"/>
    <id>http://ultlog.com/2020/07/29/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/%E6%B5%8B%E8%AF%95/benchmark/</id>
    <published>2020-07-29T14:09:01.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本次性能测试有以下几点说明</p><ul><li>仅针对ula服务进行查询测试。</li><li>测试的目标ula服务与elasticsearch服务都为默认配置。即二者启动时均未对连接数/内存等进行调整。详见<a href="#系统配置">系统配置</a>。</li><li>仅对ula中日志接口（/api/v1/log）进行测试，该接口内部包含两次elasticsearch查询，加之日常使用极少深度分页，因此该接口在一定程度上能够作为测试基准。</li><li>本次性能测试的目标为满足五十人左右团队使用时接口不会出现大于1000ms响应。</li><li>经日常工作经验可知团队内同时使用ultlog的人数大约为1/10 - 1/5 ，因此取极限10绝对并发进行测试。</li><li>本次测试的总请求次数设置为50*10，即10人各自连续调用服务50次，较大于日常使用ultlog查询日志时的实际情况，因此可以覆盖日常使用的极限值。</li><li>本次测试的数据量为数日积累，大约在三百万左右。</li></ul><h1 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h1><p>在测试之前，待测试ula服务，elasticsearch服务，搭载服务的虚拟机的配置如下</p><h2 id="ula"><a href="#ula" class="headerlink" title="ula"></a>ula</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -heap &#123;ula pid&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Heap Configuration:</span><br><span class="line">   MinHeapFreeRatio         &#x3D; 0</span><br><span class="line">   MaxHeapFreeRatio         &#x3D; 100</span><br><span class="line">   MaxHeapSize              &#x3D; 2065694720 (1970.0MB)</span><br><span class="line">   NewSize                  &#x3D; 42991616 (41.0MB)</span><br><span class="line">   MaxNewSize               &#x3D; 688390144 (656.5MB)</span><br><span class="line">   OldSize                  &#x3D; 87031808 (83.0MB)</span><br><span class="line">   NewRatio                 &#x3D; 2</span><br><span class="line">   SurvivorRatio            &#x3D; 8</span><br><span class="line">   MetaspaceSize            &#x3D; 21807104 (20.796875MB)</span><br><span class="line">   CompressedClassSpaceSize &#x3D; 1073741824 (1024.0MB)</span><br><span class="line">   MaxMetaspaceSize         &#x3D; 17592186044415 MB</span><br><span class="line">   G1HeapRegionSize         &#x3D; 0 (0.0MB)</span><br><span class="line"></span><br><span class="line">Heap Usage:</span><br><span class="line">PS Young Generation</span><br><span class="line">Eden Space:</span><br><span class="line">   capacity &#x3D; 30932992 (29.5MB)</span><br><span class="line">   used     &#x3D; 22519952 (21.476699829101562MB)</span><br><span class="line">   free     &#x3D; 8413040 (8.023300170898438MB)</span><br><span class="line">   72.80237230203919% used</span><br></pre></td></tr></table></figure><p>更多参数可见<a href="https://github.com/ultlog/ula/tree/master/benchmark/ula_config" target="_blank" rel="external nofollow noopener noreferrer">ula_config</a></p><h2 id="elasticsearch"><a href="#elasticsearch" class="headerlink" title="elasticsearch"></a>elasticsearch</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">jhsdb jmap --heap --pid &#123;elasticsearch pid&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Heap Configuration:</span><br><span class="line">   MinHeapFreeRatio         &#x3D; 40</span><br><span class="line">   MaxHeapFreeRatio         &#x3D; 70</span><br><span class="line">   MaxHeapSize              &#x3D; 1073741824 (1024.0MB)</span><br><span class="line">   NewSize                  &#x3D; 348913664 (332.75MB)</span><br><span class="line">   MaxNewSize               &#x3D; 348913664 (332.75MB)</span><br><span class="line">   OldSize                  &#x3D; 724828160 (691.25MB)</span><br><span class="line">   NewRatio                 &#x3D; 2</span><br><span class="line">   SurvivorRatio            &#x3D; 8</span><br><span class="line">   MetaspaceSize            &#x3D; 21807104 (20.796875MB)</span><br><span class="line">   CompressedClassSpaceSize &#x3D; 1073741824 (1024.0MB)</span><br><span class="line">   MaxMetaspaceSize         &#x3D; 17592186044415 MB</span><br><span class="line">   G1HeapRegionSize         &#x3D; 0 (0.0MB)</span><br><span class="line"></span><br><span class="line">Heap Usage:</span><br><span class="line">New Generation (Eden + 1 Survivor Space):</span><br><span class="line">   capacity &#x3D; 314048512 (299.5MB)</span><br><span class="line">   used     &#x3D; 248085416 (236.59268951416016MB)</span><br><span class="line">   free     &#x3D; 65963096 (62.907310485839844MB)</span><br><span class="line">   78.99588965414362% used</span><br></pre></td></tr></table></figure><h3 id="数据量"><a href="#数据量" class="headerlink" title="数据量"></a>数据量</h3><p>本次测试的数据量通过如下命令获得：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &#123;elasticsearch host&#125;/ult_index/_count</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"count"</span>:<span class="number">34232030</span>,<span class="attr">"_shards"</span>:&#123;<span class="attr">"total"</span>:<span class="number">1</span>,<span class="attr">"successful"</span>:<span class="number">1</span>,<span class="attr">"skipped"</span>:<span class="number">0</span>,<span class="attr">"failed"</span>:<span class="number">0</span>&#125;&#125;</span><br></pre></td></tr></table></figure><p>更多参数可见<a href="https://github.com/ultlog/ula/tree/master/benchmark/ela_config" target="_blank" rel="external nofollow noopener noreferrer">ula_config</a></p><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">files=$(ls /proc/sys/net/ipv4)</span><br><span class="line">for file in $files</span><br><span class="line">do</span><br><span class="line">  echo "$file" </span><br><span class="line">  cat "$1"/"$file"</span><br><span class="line">done</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cipso_cache_bucket_size</span><br><span class="line">10</span><br><span class="line">cipso_cache_enable</span><br><span class="line">1</span><br><span class="line">cipso_rbm_optfmt</span><br><span class="line">0</span><br><span class="line">cipso_rbm_strictvalid</span><br><span class="line">1</span><br><span class="line">conf</span><br><span class="line">icmp_echo_ignore_all</span><br><span class="line">0</span><br><span class="line">icmp_echo_ignore_broadcasts</span><br><span class="line">1</span><br><span class="line">icmp_errors_use_inbound_ifaddr</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>更多参数可见<a href="https://github.com/ultlog/ula/tree/master/benchmark/ipv4_config" target="_blank" rel="external nofollow noopener noreferrer">ula_config</a></p><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><h2 id="测试工具"><a href="#测试工具" class="headerlink" title="测试工具"></a>测试工具</h2><p>本次测试选择apachbench进行测试，根据<a href="#前言">前言</a>中所写得到以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -n 500 -c 10 -g ula_test_output http://&#123;target&#125;/api/v1/log</span><br></pre></td></tr></table></figure><h1 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h1><h2 id="测试报告"><a href="#测试报告" class="headerlink" title="测试报告"></a>测试报告</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">This is ApacheBench, Version 2.3 &lt;$Revision: 1874286 $&gt;</span><br><span class="line">Copyright 1996 Adam Twiss, Zeus Technology Ltd, http:&#x2F;&#x2F;www.zeustech.net&#x2F;</span><br><span class="line">Licensed to The Apache Software Foundation, http:&#x2F;&#x2F;www.apache.org&#x2F;</span><br><span class="line"></span><br><span class="line">Benchmarking &#123;target&#125; (be patient)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Server Software:        nginx&#x2F;1.17.1</span><br><span class="line">Server Hostname:        &#123;target&#125;</span><br><span class="line">Server Port:            80</span><br><span class="line"></span><br><span class="line">Document Path:          &#x2F;api&#x2F;v1&#x2F;log</span><br><span class="line">Document Length:        4186 bytes</span><br><span class="line"></span><br><span class="line">Concurrency Level:      10</span><br><span class="line">Time taken for tests:   6.133 seconds</span><br><span class="line">Complete requests:      500</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      2201000 bytes</span><br><span class="line">HTML transferred:       2093000 bytes</span><br><span class="line">Requests per second:    81.53 [#&#x2F;sec] (mean)</span><br><span class="line">Time per request:       122.660 [ms] (mean)</span><br><span class="line">Time per request:       12.266 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          350.47 [Kbytes&#x2F;sec] received</span><br><span class="line"></span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+&#x2F;-sd] median   max</span><br><span class="line">Connect:        0    2   1.9      2      15</span><br><span class="line">Processing:    28  105  58.8     91     838</span><br><span class="line">Waiting:       27  102  58.1     88     821</span><br><span class="line">Total:         31  107  58.9     94     839</span><br><span class="line"></span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line">  50%     94</span><br><span class="line">  66%    115</span><br><span class="line">  75%    128</span><br><span class="line">  80%    136</span><br><span class="line">  90%    180</span><br><span class="line">  95%    211</span><br><span class="line">  98%    243</span><br><span class="line">  99%    268</span><br><span class="line"> 100%    839 (longest request)</span><br></pre></td></tr></table></figure><h2 id="输出结果"><a href="#输出结果" class="headerlink" title="输出结果"></a>输出结果</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">starttimesecondsctimedtimettimewait</span><br><span class="line">Wed Jul 29 18:39:46 202015960191863283127</span><br><span class="line">Wed Jul 29 18:39:47 202015960191872353735</span><br><span class="line">Wed Jul 29 18:39:43 202015960191831363735</span><br><span class="line">Wed Jul 29 18:39:43 202015960191835333830</span><br><span class="line">Wed Jul 29 18:39:43 202015960191831373834</span><br><span class="line">Wed Jul 29 18:39:45 202015960191851383937</span><br><span class="line">Wed Jul 29 18:39:47 202015960191875343934</span><br><span class="line">Wed Jul 29 18:39:46 202015960191861394038</span><br><span class="line">Wed Jul 29 18:39:43 202015960191832384038</span><br><span class="line">Wed Jul 29 18:39:45 202015960191859314028</span><br></pre></td></tr></table></figure><p>更多可见<a href="https://github.com/ultlog/ula/tree/master/benchmark/ula_test_output" target="_blank" rel="external nofollow noopener noreferrer">ula_test_output</a></p><h1 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h1><p>由测试结果可知本次性能测试可以通过。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;本次性能测试有以下几点说明&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;仅针对ula服务进行查询测试。&lt;/li&gt;
&lt;li&gt;测试的目标ula服务与elastic
      
    
    </summary>
    
    
      <category term="系统说明" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/"/>
    
      <category term="测试" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="性能" scheme="http://ultlog.com/tags/%E6%80%A7%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>ulu</title>
    <link href="http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ulu/ulu/"/>
    <id>http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ulu/ulu/</id>
    <published>2020-07-26T12:06:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ulu全称未ultlog-ui，是ultlog系统中展示日志的web程序。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>点击<a href="https://github.com/ultlog/ulu/releases" target="_blank" rel="external nofollow noopener noreferrer">此处</a>下载。</p><p><code>如果部署在windows系统，可以选择下载ulu-nginx，其自带一个免安装版本的nginx。</code></p><h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><p>将下载的文件解压到nginx的html路径下，目录结构为<br><code>{base_path}/nginx/html/index.html</code> 和 <code>{base_path}/nginx/html/static</code></p><p>修改nginx配置文件中的反向代理配置，添加如下代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location ^~ &#x2F;api &#123;</span><br><span class="line">    proxy_pass http:&#x2F;&#x2F;&#123;ula-host&#125;:&#123;ula-ip&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将其中ula-ip/port替换为ula服务部署的地址和端口</p><h4 id="启动nginx"><a href="#启动nginx" class="headerlink" title="启动nginx"></a>启动nginx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start nginx</span><br></pre></td></tr></table></figure><h2 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h2><p>更多关于ulu的信息可以访问<a href="http://ultlog.com">ultlog文档中心</a>查阅。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ulu全称未ultlog-ui，是ultlog系统中展示日志的web程序。&lt;/p&gt;
&lt;h2 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; cl
      
    
    </summary>
    
    
      <category term="系统说明" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/"/>
    
      <category term="ulu" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ulu/"/>
    
    
      <category term="ulu" scheme="http://ultlog.com/tags/ulu/"/>
    
  </entry>
  
  <entry>
    <title>ula</title>
    <link href="http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ula/ula/"/>
    <id>http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ula/ula/</id>
    <published>2020-07-26T12:04:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ula"><a href="#ula" class="headerlink" title="ula"></a>ula</h1><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><p>需要7.x版本的<a href="https://www.elastic.co/" target="_blank" rel="external nofollow noopener noreferrer">Elasticsearch</a></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>点击<a href="https://github.com/ultlog/ula/releases" target="_blank" rel="external nofollow noopener noreferrer">此处</a>下载ula-0.0.1.jar</p><h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar -D"ultlog.es.address.host=&#123;es-ip&#125;" -D"ultlog.es.address.port=&#123;es-port&#125;"   ula-0.0.1.jar</span><br></pre></td></tr></table></figure><p>替换其中es-ip与es-port</p><h3 id="个性化"><a href="#个性化" class="headerlink" title="个性化"></a>个性化</h3><p>如果需要修改端口ip等配置信息可以在启动项加入</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dspring.port=8888</span><br></pre></td></tr></table></figure><p>更建议创建一个配置文件在同级目录，修改配置更方便。</p><h2 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h2><p>更多关于ulu的信息可以访问<a href="http://ultlog.com">ultlog文档中心</a>查阅。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ula&quot;&gt;&lt;a href=&quot;#ula&quot; class=&quot;headerlink&quot; title=&quot;ula&quot;&gt;&lt;/a&gt;ula&lt;/h1&gt;&lt;h2 id=&quot;前置&quot;&gt;&lt;a href=&quot;#前置&quot; class=&quot;headerlink&quot; title=&quot;前置&quot;&gt;&lt;/a&gt;前置&lt;/h2&gt;&lt;p
      
    
    </summary>
    
    
      <category term="系统说明" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/"/>
    
      <category term="ula" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/ula/"/>
    
    
      <category term="ula" scheme="http://ultlog.com/tags/ula/"/>
    
  </entry>
  
  <entry>
    <title>searcher</title>
    <link href="http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/searcher/searcher/"/>
    <id>http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/searcher/searcher/</id>
    <published>2020-07-26T12:02:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>searcher 是ultlog系统中收集日志的一个程序。通过对系统中日志文件的监控，实时的将产生的日志发送到ula中。<br>与<a href="https://github.com/ultlog/collector" target="_blank" rel="external nofollow noopener noreferrer">collector</a>不同，searcher不需要在工程中集成，转而在操作系统中集成。<br>因此一些非基于logback的java项目（非常少）或非java项目也可以通过修改日志的格式而将日志托管给ultlog，享受ultlog带来的便利。</p><h2 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h2><p>searcher使用java编写，因此在应用searcher的操作系统上需要<a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html" target="_blank" rel="external nofollow noopener noreferrer">jdk8</a>以上的环境，若系统中没有以上环境则可以使用自带jdk的searcher包进行部署。</p><p>建议将执行脚本下载到内网，通过minio，ftp或http服务挂载，并以此编写自动集成脚本，具体可见<a href="#自动集成实践">自动集成实践</a>。</p><p>如果有大量环境需要集成建议查看<a href="#自动集成实践">自动集成实践</a>来快速编写自动集成脚本。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="程序配置"><a href="#程序配置" class="headerlink" title="程序配置"></a>程序配置</h3><p>将要应用searcher的程序的logback日志格式应如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%d&#123;yyyy-MM-dd HH:mm:ss&#125; [%-5level] [%-5thread] %logger&#123;20&#125; - %msg%n&lt;&#x2F;pattern&gt;</span><br></pre></td></tr></table></figure><p>如果非logback项目或非java项目应将日志格式调整为如此：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2020-07-21 09:16:37 [ERROR] [pool-420-thread-7] c.t.g.h.HttpConnectionPoolUtil - test error</span><br><span class="line">java.lang.RuntimeException: test error</span><br><span class="line">at com.example.demo.DemoApplicationTests.contextLoads(DemoApplicationTests.java:21)</span><br><span class="line">....</span><br></pre></td></tr></table></figure><h3 id="选择软件包"><a href="#选择软件包" class="headerlink" title="选择软件包"></a>选择软件包</h3><table><thead><tr><th>环境</th><th>软件包</th></tr></thead><tbody><tr><td>&lt;  jdk 1.8</td><td><a href>searcher_jdk.tar.gz</a></td></tr><tr><td>&gt;=  jdk 1.8</td><td><a href>searcher.tar.gz</a></td></tr><tr><td>无jdk</td><td><a href>searcher_jdk.tar.gz</a></td></tr></tbody></table><h3 id="手动-单机集成"><a href="#手动-单机集成" class="headerlink" title="手动/单机集成"></a>手动/单机集成</h3><h4 id="docker-linux"><a href="#docker-linux" class="headerlink" title="docker linux"></a>docker linux</h4><ul><li>使用exec等命令进入docker镜像</li><li>将下载好的软件包传入（可以在镜像内使用curl等命令进行下载）</li><li>解压文件</li><li>执行 sh searcher.sh <a href="#配置项说明">{args}</a></li></ul><h4 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h4><ul><li>将下载好的软件包传入 可以在镜像内使用curl等命令进行下载</li><li>解压文件</li><li>执行 sh searcher.sh <a href="#配置项说明">{args}</a></li></ul><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><p>修改{searcher path}/application.yml，正确填写其中配置项<br>执行语句启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar searcher.jar</span><br></pre></td></tr></table></figure><p>如果是非jdk8环境</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;searcher_path&#125;/java -jar searcher.jar</span><br></pre></td></tr></table></figure><h3 id="自动集成实践"><a href="#自动集成实践" class="headerlink" title="自动集成实践"></a>自动集成实践</h3><p>自动集成提供docker环境文件的改造，如需在jenkins或其他平台集成可以参照此进行改造。</p><h4 id="原DOCKERFILE"><a href="#原DOCKERFILE" class="headerlink" title="原DOCKERFILE"></a>原DOCKERFILE</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line">ADD demo.jar /demo.jar</span><br><span class="line">ENTRYPOINT ["java","jar","/demo.jar"]</span><br></pre></td></tr></table></figure><h4 id="改造后"><a href="#改造后" class="headerlink" title="改造后"></a>改造后</h4><p>在程序同级**.jar同级目录添加名称为start.sh的脚本（可以通过cp等命令移动到jar所在目录，下同），内容如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh startSearcher.sh -f /opt/application.yml</span><br><span class="line">java -jar /demo.jar</span><br></pre></td></tr></table></figure><p>在原jar目录添加文件</p><ul><li>startSearcher.sh</li><li>application.yml</li></ul><p>修改DOCKERFILE</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM java:8</span><br><span class="line">ADD demo.jar /demo.jar</span><br><span class="line">ADD startSearcher.sh /startSearcher.sh</span><br><span class="line">ADD application.yml /opt/application.yml</span><br><span class="line">ENTRYPOINT ["sh","start.sh"]</span><br></pre></td></tr></table></figure><h3 id="配置项说明"><a href="#配置项说明" class="headerlink" title="配置项说明"></a>配置项说明</h3><h4 id="使用配置文件"><a href="#使用配置文件" class="headerlink" title="使用配置文件"></a>使用配置文件</h4><p>使用配置文件即为将软件包内部的配置文件进行修改，然后存放到需要集成searcher的系统某个地址下，通过参数指定路径即可</p><table><thead><tr><th>参数</th><th>说明</th><th>是否必填</th><th>默认值</th><th>实例</th></tr></thead><tbody><tr><td>-f , –file</td><td>配置文件的路径</td><td>√</td><td></td><td>/searcher/application.yml</td></tr></tbody></table><h4 id="直接传参"><a href="#直接传参" class="headerlink" title="直接传参"></a>直接传参</h4><p>不使用配置文件直接通过以下参数启动searcher服务</p><table><thead><tr><th>参数</th><th>说明</th><th>是否必填</th><th>默认值</th><th>实例</th></tr></thead><tbody><tr><td>-p , –path</td><td>产生日志文件的路径</td><td>√</td><td></td><td>/logs/</td></tr><tr><td>–pattern</td><td>日志文件的关键字</td><td>√</td><td></td><td>error.log</td></tr><tr><td>–project</td><td>项目名称</td><td>√</td><td></td><td>ultlog</td></tr><tr><td>-m , –module</td><td>模块名称</td><td>√</td><td></td><td>searcher</td></tr><tr><td>–uuid</td><td>服务唯一属性</td><td>√</td><td></td><td>4RFS23Q</td></tr><tr><td>–max</td><td>同时监控的最多文件数</td><td>×</td><td>10</td><td>12</td></tr><tr><td>–level</td><td>收集日志的最低等级</td><td>×</td><td>INFO</td><td>WARN</td></tr><tr><td>-u , –ula</td><td>ula服务地址</td><td>√</td><td></td><td><a href="http://192.168.2.2:8080/" target="_blank" rel="external nofollow noopener noreferrer">http://192.168.2.2:8080/</a></td></tr></tbody></table><h4 id="配置实例"><a href="#配置实例" class="headerlink" title="配置实例"></a>配置实例</h4><p>以下是测试时使用的配置文件，仅供参考</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ultlog:</span></span><br><span class="line">  <span class="attr">searcher:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">F:\Java\Workspace\ultlog\collector\logs</span></span><br><span class="line">    <span class="attr">pattern:</span> <span class="string">demo</span></span><br><span class="line">    <span class="attr">max:</span> <span class="number">10</span></span><br><span class="line">    <span class="attr">project:</span> <span class="string">searcherTest</span></span><br><span class="line">    <span class="attr">module:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">uuid:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">log:</span></span><br><span class="line">      <span class="attr">level:</span> <span class="string">INFO</span></span><br><span class="line">  <span class="attr">ula:</span></span><br><span class="line">    <span class="attr">url:</span>  <span class="string">http://localhost:8080/</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;searcher 是ultlog系统中收集日志的一个程序。通过对系统中日志文件的监控，实时的将产生的日志发送到ula中。&lt;br&gt;与&lt;a hr
      
    
    </summary>
    
    
      <category term="系统说明" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/"/>
    
      <category term="searcher" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/searcher/"/>
    
    
      <category term="searcher" scheme="http://ultlog.com/tags/searcher/"/>
    
  </entry>
  
  <entry>
    <title>未来规划</title>
    <link href="http://ultlog.com/2020/07/26/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/feature/"/>
    <id>http://ultlog.com/2020/07/26/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/feature/</id>
    <published>2020-07-26T12:00:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2020-07-29"><a href="#2020-07-29" class="headerlink" title="2020-07-29"></a>2020-07-29</h2><ul><li>基于kafka的日志发送，即不依赖于http请求</li><li>ula缓存</li><li>ula均衡负载</li><li>ula对elasticsearch的鉴权，集群适配</li><li>短信/邮件告警</li><li>golang版本的searcher</li><li>英文文档</li><li>docker版ulu与ula</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;2020-07-29&quot;&gt;&lt;a href=&quot;#2020-07-29&quot; class=&quot;headerlink&quot; title=&quot;2020-07-29&quot;&gt;&lt;/a&gt;2020-07-29&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;基于kafka的日志发送，即不依赖于http请求&lt;/li&gt;
&lt;l
      
    
    </summary>
    
    
      <category term="版本变更" scheme="http://ultlog.com/categories/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/"/>
    
    
      <category term="version feature" scheme="http://ultlog.com/tags/version-feature/"/>
    
  </entry>
  
  <entry>
    <title>collector</title>
    <link href="http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/collector/collector/"/>
    <id>http://ultlog.com/2020/07/26/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/collector/collector/</id>
    <published>2020-07-26T12:00:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>collector是基于logback开发的日志收集组件，适用于使用logback日志框架的系统。collector通过对logback框架中的appender接口扩展而将收集到的日志发送到<a href="#ula">ula</a>系统。相比于searcher，<br>collector能够适应更改多变的日志格式，并且在部署时不需要编写额外的脚本。</p><h2 id="集成"><a href="#集成" class="headerlink" title="集成"></a>集成</h2><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ultlog<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>collector<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="集成-1"><a href="#集成-1" class="headerlink" title="集成"></a>集成</h3><p>在logback.xml/logback-test.xml等生效的logback配置文件中添加如下配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"ultlog"</span> <span class="attr">class</span>=<span class="string">"com.ultlog.collector.appender.UlaAppender"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"&#123;ula&#125;/api/v1/log"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"project"</span> <span class="attr">value</span>=<span class="string">"&#123;project&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"module"</span> <span class="attr">value</span>=<span class="string">"&#123;module&#125;"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"uuid"</span> <span class="attr">value</span>=<span class="string">"&#123;uuid&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">"ERROR"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"ultlog"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="异步处理日志"><a href="#异步处理日志" class="headerlink" title="异步处理日志"></a>异步处理日志</h4><p>如果想使用异步appender可以采用logback文档中<a href="http://www.logback.cn/04%E7%AC%AC%E5%9B%9B%E7%AB%A0Appenders.html" target="_blank" rel="external nofollow noopener noreferrer">appender</a>文档中的AsyncAppender部分。</p><h4 id="配置项说明"><a href="#配置项说明" class="headerlink" title="配置项说明"></a>配置项说明</h4><table><thead><tr><th>配置项</th><th>说明</th></tr></thead><tbody><tr><td>ula</td><td>ula服务的地址</td></tr><tr><td>project</td><td>项目名称</td></tr><tr><td>module</td><td>模块名称（如果非微服务项目可以与project相等）</td></tr><tr><td>uuid</td><td>服务唯一属性</td></tr></tbody></table><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><pre><code class="xml"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"ultlog"</span> <span class="attr">class</span>=<span class="string">"com.ultlog.collector.appender.AsyncEsAppender"</span>&gt;</span>    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"threadPoolProviderName"</span> <span class="attr">value</span>=<span class="string">"com.ultlog.collector.support.DefaultThreadPoolProvider"</span>/&gt;</span>    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"http://localhost:8080/api/v1/log"</span>/&gt;</span>    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"project"</span> <span class="attr">value</span>=<span class="string">"ula-test"</span>/&gt;</span>    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"module"</span> <span class="attr">value</span>=<span class="string">"ula-test"</span>/&gt;</span>    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"uuid"</span> <span class="attr">value</span>=<span class="string">"ula-test-uuid"</span>/&gt;</span><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;collector是基于logback开发的日志收集组件，适用于使用logback日志框架的系统。collector通过对logback框架
      
    
    </summary>
    
    
      <category term="系统说明" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/"/>
    
      <category term="collector" scheme="http://ultlog.com/categories/%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E/collector/"/>
    
    
      <category term="collector" scheme="http://ultlog.com/tags/collector/"/>
    
  </entry>
  
  <entry>
    <title>v0.0.1</title>
    <link href="http://ultlog.com/2020/07/19/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/v0-0-1/"/>
    <id>http://ultlog.com/2020/07/19/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/v0-0-1/</id>
    <published>2020-07-19T06:59:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="功能新增"><a href="#功能新增" class="headerlink" title="功能新增"></a>功能新增</h1><ul><li>增加了collector</li><li>增加了ulu</li><li>增加了ulu</li><li>通过collector完成了基本的日志收集与展示功能</li></ul><h1 id="功能变动"><a href="#功能变动" class="headerlink" title="功能变动"></a>功能变动</h1><p>无</p><h1 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h1><p>无</p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>该版本为预览版本，仅作功能演示用，因此仍有功能亟待开发，部分低优先级问题将在v1.0.0版本统一解决。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;功能新增&quot;&gt;&lt;a href=&quot;#功能新增&quot; class=&quot;headerlink&quot; title=&quot;功能新增&quot;&gt;&lt;/a&gt;功能新增&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;增加了collector&lt;/li&gt;
&lt;li&gt;增加了ulu&lt;/li&gt;
&lt;li&gt;增加了ulu&lt;/li&gt;
&lt;li&gt;通过
      
    
    </summary>
    
    
      <category term="版本变更" scheme="http://ultlog.com/categories/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/"/>
    
    
      <category term="version" scheme="http://ultlog.com/tags/version/"/>
    
  </entry>
  
  <entry>
    <title>v1.0.0</title>
    <link href="http://ultlog.com/2020/07/19/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/v1-0-0/"/>
    <id>http://ultlog.com/2020/07/19/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/v1-0-0/</id>
    <published>2020-07-19T06:59:42.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="版本变更" scheme="http://ultlog.com/categories/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4/"/>
    
    
      <category term="version" scheme="http://ultlog.com/tags/version/"/>
    
  </entry>
  
  <entry>
    <title>ultlog</title>
    <link href="http://ultlog.com/2020/07/19/index/"/>
    <id>http://ultlog.com/2020/07/19/index/</id>
    <published>2020-07-19T06:19:01.000Z</published>
    <updated>2020-07-29T15:07:50.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>ultlog是一个日志收集，过滤，展示的系统。<br>基于高性能地<a href="https://www.elastic.co/cn/cloud/?elektra=home&storm=sub1" target="_blank" rel="external nofollow noopener noreferrer">Elasticsearch</a>以及<a href="https://github.com/qos-ch/logback" target="_blank" rel="external nofollow noopener noreferrer">logback</a>等java框架，可以快速地对线上日志数据进行收集，并且提供ula页面进行日志地展示。<br>相比于原始地日志系统/框架，ultlog有如下优势：</p><ul><li>分布式系统日志能够地统一收集</li><li>避免了登录虚拟机/跳板机查询日志</li><li>可以通过时间或关键字进行日志检索，省去了编写查询语句的时间</li><li>可以以服务/模块/系统唯一标识等属性区分日志，方便微服务架构下日志的准确查找</li><li>性能优越，单机ultlog以及单机elasticsearch服务可以轻松满足数十人团队，日均五十余万条日志的存储与查询。</li></ul><p><a href="#开始使用">开始使用</a></p><h1 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h1><h2 id="日志数据流转"><a href="#日志数据流转" class="headerlink" title="日志数据流转"></a>日志数据流转</h2><img src="/2020/07/19/index/ultlog.png" class title="ultlog日志数据流转图:vi&#x2F;vim-cheat-sheet"><h2 id="searcher"><a href="#searcher" class="headerlink" title="searcher"></a>searcher</h2><p>searcher 是ultlog系统中收集日志的一个程序。通过对系统中日志文件的监控，实时的将产生的日志发送到ula中。<br>与<a href="https://github.com/ultlog/collector" target="_blank" rel="external nofollow noopener noreferrer">collector</a>不同，searcher不需要在工程中集成，转而在操作系统中集成。<br>因此一些非基于logback的java项目（非常少）或非java项目也可以通过修改日志的格式而将日志托管给ultlog，享受ultlog带来的便利。</p><h2 id="collector"><a href="#collector" class="headerlink" title="collector"></a>collector</h2><p>collector是基于logback开发的日志收集组件，适用于使用logback日志框架的系统。collector通过对logback框架中的appender接口扩展而将收集到的日志发送到<a href="#ula">ula</a>系统。相比于searcher，<br>collector能够适应更改多变的日志格式，并且在部署时不需要编写额外的脚本。</p><h2 id="ula"><a href="#ula" class="headerlink" title="ula"></a>ula</h2><p>ula为ultlog系统中的日志与网络请求处理服务，收集到的日志通过ula存储进Elasticsearch数据库，并且通过Restful风格的接口对外提供查询功能。</p><h2 id="ulu"><a href="#ulu" class="headerlink" title="ulu"></a>ulu</h2><p>ulu为ultlog系统日志展示程序。可以通过系统名称，日志产生时间，日志信息等多个维度进行日志的查询。</p><h1 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h1><p><a href="/2020/07/26/系统说明/ula/ula/">ula部署说明</a><br><a href="/2020/07/26/系统说明/ulu/ulu/">ulu部署说明</a><br><a href="/2020/07/26/系统说明/collector/collector/">collector部署说明</a><br><a href="/2020/07/26/系统说明/searcher/searcher/">searcher部署说明</a></p><h1 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h1><p>关于ultlog的性能可以查看<a href="/2020/07/29/系统说明/测试/benchmark/">性能测试</a>章节。</p><h1 id="未来规划"><a href="#未来规划" class="headerlink" title="未来规划"></a>未来规划</h1><p>更多新功能正在开发，欢迎通过<a href="/2020/07/26/版本变更/feature/">未来规划</a>查阅。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;ultlog是一个日志收集，过滤，展示的系统。&lt;br&gt;基于高性能地&lt;a href=&quot;https://www.elastic.co/cn/cl
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
